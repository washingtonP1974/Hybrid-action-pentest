import socket

def vhost_scan(ip):
    try:
        for port in range(1, 1025):
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            socket.setdefaulttimeout(1)

            # Connect to the target IP and port
            result = s.connect_ex((ip, port))
            if result == 0:
                print(f"Port {port}: Open")

                # Send a simple HTTP request to check for virtual hosts
                s.sendall(b"GET / HTTP/1.1\r\nHost: example.com\r\n\r\n")
                response = s.recv(1024)

                # Check if the response contains information about virtual hosts
                if b"Server:" in response or b"Location:" in response:
                    print(f"Possible virtual host found on Port {port}")

            s.close()

    except socket.error as e:
        print(f"Error: {e}")

if __name__ == "__main__":
    try:
        # Get the target IP address from the user
        target_ip = input("Enter the target IP address: ")

        # Perform the virtual host scan
        vhost_scan(target_ip)

    except KeyboardInterrupt:
        print("\nScan aborted by user.")
